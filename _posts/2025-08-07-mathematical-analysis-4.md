---
layout: post
date: 2025-8-7T13:57:47+08:00
title: 数学分析笔记四：导数
tags: 
  - 读书笔记
  - 数学
---

<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>

## 导数与微分的概念

**定义**：设函数 $f(x)$ 在 $x_0$ 点邻近有定义，如果存在有穷极限 $\lim_{x\to x_0}\frac{f(x)-f(x_0)}{x-x_0}$，那我们就说函数 $f(x)$ 在 $x_0$ 点可导，并把上述极限值称为函数 $f(x)$ 在 $x_0$ 点的导数，记为 $f'(x_0)$（拉格朗日 Lagrange 记号）。此外还常采用莱布尼兹 Leibnitz 的记号 $\frac{d(f(x_0))}{dx}$（或 $\frac{dy}{dx}$）。

**定理 1：设函数 $f$ 和 $g$ 在 $x$ 点可导，$c \in \mathbf{R}$，则 $f+g$ 和 $cf$ 也在 $x$ 点可导。并且 $(f(x) + g(x))' = f'(x) + g'(x); (cf(x))' = cf'(x)$**

**定义（单侧导数）**：设函数 $f$ 在 $(x-\eta, x]$ 有定义，如果存在有穷的左侧极限 $\lim_{h\to 0-} \frac{f(x+h) - f(x)}{h}$，那么我们说函数 $f$ 在 $x$ 点**左侧可导**，并把上述左侧极限称为函数 $f$ 在 $x$ 点的**左导数**。右导数类似。

**定理 2：设函数 $f$ 在 $x$ 点邻近有定义，则 $f$ 在 $x$ 点可导的充分必要条件是它在这点的两个单侧导数都存在且相等：$f_{-}'(x) = f_{+}'(x)$。当这条件满足，就有 $f'(x) = f_{-}'(x) = f_{+}'(x)$。**

**定义**：设函数 $f(x)$ 在 $x$ 点邻近有定义，如果 $f(x+h)-f(x)=Ah + o(h)$，其中 $A$ 与 $h$ 无关，那么就说函数 $f$ 在 $x$ 点**可微**。

**定理 3：函数 $f$ 在 $x$ 点可导的充分必要条件是它在这点可微。**

**定理 4：设函数 $f(x)$ 在 $x_0$ 点可微（可导），那么它在这点连续（逆之不成立）。**

**定义**：设函数 $y = f(x)$ 在 $x_0$ 点可微，我们引入记号 $dx := \Delta x, dy:= f'(x_0)dx = f'(x_0)\Delta x$，并把 $dy$ 叫做函数 $y=f(x)$ 在 $x_0$ 点的**微分**。$\frac{dy}{dx} = f'(x_0)$。

## 求导法则，高阶导数

### 和、差、积、商的求导法则

**定理 1：设函数 $u$ 和 $v$ 在 $x_0$ 点可导，则以下各式在 $x = x_0$ 处成立：**

1. $(u(x) \pm v(x))' = u'(x) \pm v'(x)$
2. $(u(x)v(x))' = u'(x)v(x) + u(x)v'(x)$
3. $(\frac{u(x)}{v(x)})' = \frac{u'(x)v(x) - u(x)v'(x)}{(v(x))^2}, v(x)\neq 0$

公式 3 中取 $u(x) \equiv 1$ 就得到 $(\frac{1}{v(x)})' = -\frac{v'(x)}{(v(x))^2}$

**定理 1'：设函数 $u$ 和 $v$ 都在 $x$ 点可微，则有：**
1. $d(u(x)\pm v(x)) = du(x)\pm dv(x)$
2. $d(u(x)v(x)) = v(x)du(x)+u(x)dv(x)$
3. $d(\frac{u(x)}{v(x)}) = \frac{v(x)du(x) - u(x)dv(x)}{(v(x))^2}$

### 复合函数的求导。微分表示的不变性

**定理 2：设函数 $f(x)$ 在 $x_0$ 点可导，函数 $g(y)$ 在 $y_0=f(x_0)$ 点可导，则复合函数 $\phi(x) = g\circ f(x)$ 也在 $x_0$ 点可导，并且 $\phi'(x_0) = g'(f(x_0))f'(x_0)$。**


将复合函数 $f(\phi(t))$ 对 $t$ 求导得 $(f(\phi(t)))' = f'(\phi(t))\phi'(t)$。这式子两边都乘以 $dt$ 就 得到 $d(f(\phi(t))) = f'(\phi(t))d\phi(t)$。这就是说：不论 $x$ 是自变量，或者 $x=\phi(t)$
 是另一变量 $t$ 的函数，函数 $f(x)$ 的微分表示式都具有相同的形式 $df(x) = f'(x)dx$。这一结论叫做**微分表示的不变性**。

定理 2 中所述的复合函数求导法则又称为**链式法则**。对于函数 $z=g(y)$ 与 $y=f(x)$ 的复合，这一法则可以形式地写成 $\frac{dz}{dx} = \frac{dz}{dy}\cdot\frac{dy}{dx}$。欲求复合函数对自变量的导数，可以先求它对中间变量的导数，再乘以中间变量对自变量的导数。

### 反函数的求导法则

**定理 3：设函数 $y=\phi(x)$ 在包含 $x_0$ 点的开区间 $I$ 上严格单调并连续。如果这函数在 $x_0$ 点可导且导数 $\phi'(x_0) \neq 0$，那么反函数 $x = \psi(y)$ 在点 $y_0 = \phi(x_0)$ 可导，并且 $\psi'(y_0) = \frac{1}{\phi'(x_0)} = \frac{1}{\phi'(\psi(y_0))}$。**

证明：在所给定的条件下，函数 $x=\psi(y)$ 也严格单调并连续，于是，当 $y\neq y_0, y\to y_0$ 时，应有 $\psi(y)\neq \psi(y_0), \psi(y) \to \psi(y_0)$。因而

$$
\begin{aligned}
\lim_{y\to y_0}\frac{\psi(y)-\psi(y_0)}{y-y_0}&=\lim_{y\to y_0}\frac{1}{\frac{y-y_0}{\psi(y)-\psi(y_0)}} \\
&=\lim_{x\to x_0}\frac{1}{\frac{\phi(x) - \phi(x_0)}{x-x_0}} \\
&=\frac{1}{\phi'(x_0)} = \frac{1}{\phi'(\psi(y_0))}
\end{aligned}
$$

如果函数 $y=\phi(x)$ 在开区间 $I$ 严格单调，在这区间的每一个点 $x$ 都可导并且有 $\phi'(x)\neq 0$，那么反函数 $x=\psi(y)$ 在开区间 $J=\phi(I)$ 的每一点 $y$ 处都可导，并且 $\psi'(y) = \frac{1}{\phi'(\psi(y))}$。可以形式地写为 $\frac{dy}{dx}=\frac{1}{\frac{dx}{dy}}$。

### 参数式或隐式表示的函数的求导

对于参数表示的函数 $x = \phi(t), y = \psi(t)$，可以按下式求导：

$$
\frac{dy}{dx}=\frac{\psi'(t)}{\phi'(t)}
$$

### 高阶导数

设函数 $f$ 在开区间 $I$ 的每一点可导，则以下对应关系定义了一个函数:

$$
x \mapsto f'(x), \forall x \in I
$$

这函数称为函数 $f$ 的**导函数**，记为 $f'$。导函数 $f'$ 在 $x$ 点的导数 $(f')'(x)$，称为是函数 $f$ 在 $x$ 点的二阶导数，记为 $f^{\prime\prime}(x), f^{(2)}(x)$ 或者 $\frac{d^2y}{dx^2}$。

如果导数 $f^{(n-1)}$ 在 $x$ 点具有导数 $(f^{(n-1)})'(x)$，那么我们就把这导数称为是函数 $f$ 在 $x$ 点的 $n$ 阶导数，记为 $f^{(n)}(x)$ 或者 $\frac{d^ny}{dx^n}$。

**定理 4（Leibnitz 公式）：设函数 $u$ 和 $v$ 都在 $x_0$ 点 $n$ 次可导，则这两函数的乘积 $uv$ 也在 $x_0$ 点 $n$ 次可导，并且在这点有 $(uv)^{(n)} = \sum_{k=0}^n \binom{n}{k} u^{(n-k)}v^{(k)}$**

## 无穷小增量公式与有限增量公式

**定义**：设 $I$ 是一个区间，$x_0 \in I$，如果存在 $\eta > 0$，使得 $U(x_0, \eta) \subset I$，那么我们就说 $x_0$ 是区间 $I$ 的一个**内点**。

**区间 $I$ 除去端点之外的所有点都是内点，它的全体内点的集合是一个开区间，记为 $I^0$。**

**定义**：设函数 $f$ 在区间 $I$ 有定义，$x_0 \in I^0$。如果存在 $x_0$ 的一个邻域 $U(x_0, \delta) \subset I$，使得对任何 $x \in U(x_0, \delta)$ 都有 $f(x) \leq f(x_0) (f(x) \geq f(x_0))$，那我们就说函数 $f$ 在 $x_0$ 点取得**极大值**（**极小值**）$f(x_0)$。如果对任何 $x \in U(x_0, \delta)$ 都有 $f(x) < f(x_0) (f(x) > f(x_0))$，那我们就说函数 $f$ 在 $x_0$ 点取得**严格的极大值**（**严格的极小值**）$f(x_0)$。

**引理：设 $A \in \mathbf{R}, A \neq 0$，如果 $\phi(h) = Ah + o(h)~(h\to 0)$，那么可以断定：对充分小的 $h\neq 0$，$\phi(h)$ 与 $Ah$ 同号（即同时大于 0 或同时小于 0）。**

**定理 1（费马定理，极值的必要条件）：设函数 $f$ 在区间 $I$ 有定义，在这区间的内点 $x_0$ 处取得极值。如果 $f$ 在 $x_0$ 点可导，那么必有 $f'(x_0) = 0$。**

证明：用反证法。先写出无穷小增量公式：$f(x) - f(x_0) = A(x-x_0) + o(x-x_0)$，这里 $A = f'(x_0)$。假设 $A \neq 0$，那么按照上面的引理，当 $h = x - x_0$ 充分小时，$f(x) - f(x_0)$ 与 $A(x-x_0)$ 同号。如果 $A > 0$，那么

$$
f(x) - f(x_0) \begin{cases}
    < 0 & \text{对于} x \in (x_0 - \delta, x_0) \\
    > 0 & \text{对于} x \in (x_0, x_0 + \delta) 
\end{cases}
$$

这里 $\delta$ 是充分小的正数。我们看到，如果 $A > 0$，那么 $f$ 在 $x_0$ 点不可能取得极值。类似的，如果 $A < 0$，那么 $f$ 在 $x_0$ 点也不可能取得极值。因此，只要函数 $f$ 在区间的内点 $x_0$ 处可导，取得极值的必要条就是 $f'(x_0) = 0$。

**定义**：我们把使得 $f'(x_0) = 0$ 的点 $x_0$ 叫做函数 $f$ 的**临界点**。

**定理 2：设函数 $f$ 在 $[a, b]$ 连续，在 $(a, b)$ 可导。如果方程 $f'(x) = 0$ 在 $(a, b)$ 中只有有限个根 $x_1, x_2, \cdots, x_k$，那么函数 $f$ 在区间 $[a, b]$ 上最大值 $M$ 和最小值 $m$ 分别为：**

$$
M = \max\{f(a), f(x_1), \cdots, f(x_k), f(b)\}
$$

**和**

$$
M = \min\{f(a), f(x_1), \cdots, f(x_k), f(b)\}
$$

证明：在闭区间 $[a, b]$ 连续的函数 $f$ 必定取到它的最大值 $M$（最小值 $m$）。这最大值 $M$（最小值 $m$）可能在区间的端点取得，也可能在区间的内点取得。如果在内点 $x_0$ 取得最大值（最小值），那么 $x_0$ 必定是函数 $f$ 的一个临界点。

上面定理对 $f$ 在 $(a, b)$ 中无临界点的情形也适用。这时应有：$M = \max\\{f(a), f(b)\\}$ 和 $m = \min\\{f(a), f(b)\\}$。

**定理 3（罗尔定理）：设函数 $f$ 在闭区间 $[a, b]$ 连续，在开区间 $(a, b)$ 可导，并且满足 $f(a) = f(b)$，则存在 $c \in (a, b)$ 使得 $f'(c) = 0$。**

**定理 4（拉格朗日定理）：设函数 $f$ 在闭区间 $[a, b]$ 连续，在开区间 $(a, b)$ 可导，则至少存在一点 $c \in (a, b)$，使得 $f'(c) = \frac{f(b) - f(a)}{b - a}$。**

证明：作辅助函数 $F(x) = f(x) - f(a) - \frac{f(b) - f(a)}{b - a}(x-a)$。可以看到：函数 $F$ 在 $[a, b]$ 连续，在 $(a, b)$ 可导，并且满足条件 $F(a) = F(b) = 0$。根据罗尔定理，存在 $c \in (a,b)$，使得 $F'(c) = 0$。即 $f'(c) = \frac{f(b) - f(a)}{b - a}$。

拉格朗日定理又称为**中值定理**、**均值定理**。定理的结论可以改写成：存在 $c\in (a, b)$，使得 $f(b) = f(a) + f'(c)(b-a)$。设 $I$ 是任意一个区间，并设函数 $f$ 在 $I$ 连续，在 $I^0$ 可导。则对任意 $x_0, x \in I$ 都存在介于 $x_0$ 和 $x$ 之间的 $\xi$ （或者 $x_0 < \xi < x$，或者 $x < \xi < x_0$），使得 $f(x) = f(x_0) + f'(\xi)(x-x_0)$。

**定理 5：设函数 $f$ 在区间 $I$ 连续，在 $I^0$ 可导，则 $f \equiv \text{常数} \iff f'(x)=0, \forall x \in I^0$。**

证明：$\implies$ 部分是显然的。 这里证明 $\impliedby$ 部分。设 $f'(x) = 0, \forall x \in I^0$。对任意 $x_1, x_2 \in I$，存在介于 $x_1$ 和 $x_2$ 之间的 $\xi$，使得 $f(x_2) = f(x_1) + f'(\xi)(x_2 - x_1)$。因为 $f'(\xi) = 0$，所以有 $f(x_2) = f(x_1)$。因为上式对任意 $x_1, x_2 \in I$ 都成立，所以 $f$ 是常值函数。

**推论**：设 $f$ 和 $g$ 在区间 $I$ 连续，在 $I^0$ 可导。如果 $g'(x) = f'(x), \forall x \in I^0$，那么存在常数 $C$，使得 $g(x) = f(x) + C, \forall x \in I$。


**定理 7：设函数 $f$ 在区间 $I$ 连续，在 $I^0$ 可导，则有：**

1. $f$ 在 $I$ 上严格递增的充分必要条件是：$f'(x) \geq 0, \forall x \in I^0$，并且 $f'(x)$ 不在 $I$ 的任何一个开区间上恒等于 0（等于 0 只能是孤立点）；
2. $f$ 在 $I$ 上严格递减的充分必要条件是：$f'(x) \leq 0, \forall x \in I^0$，并且 $f'(x)$ 不在 $I$ 的任何一个开区间上恒等于 0（等于 0 只能是孤立点）。

**定理 8（极值第一充分条件）：设函数 $f$ 在区间 $I$ 有定义，在 $U(x_0, \eta) \subset I$ 连续，在 $\check{U}(x_0, \eta)$ 可导。（1）如果 $f'(x)(x-x_0) > 0, \forall x \in \check{U}(x_0, \eta)$，那么函数 $f$ 在 $x_0$ 点取得严格的极小值。（2）如果 $f'(x)(x-x_0) < 0, \forall x \in \check{U}(x_0, \eta)$，那么函数 $f$ 在 $x_0$ 点取得严格的极大值。**

**定理 9（极值的第二充分条件）：设函数 $f$ 在区间 $I$ 有定义，在 $x_0 \in I^0$ 处二阶可导，并设 $f'(x_0) = 0$。则有（1）如果 $f^{\prime\prime}(x_0) > 0$，那么函数 $f$ 在 $x_0$ 点取得严格的极小值；（2）如果 $f^{\prime\prime}(x_0) < 0$，那么函数 $f$ 在 $x_0$ 点取得严格的极大值。**

证明：

论断（1）证明：因为 

$$
\lim_{x \to x_0} \frac{f'(x)}{x - x_0} = \lim_{x \to x_0} \frac{f'(x) - f'(x_0)}{x - x_0} = f^{\prime \prime}(x_0) > 0
$$

所以存在 $\eta > 0$，使得 $x \in \check{U}(x_0, \eta)$ 时有 

$$
\frac{f'(x)}{x - x_0} > 0
$$

在 $\check{U}(x_0, \eta)$ 中，当 $x < x_0$ 时，$f'(x) < 0$；而当 $x > x_0$ 时，$f'(x) > 0$。因而函数 $f$ 在 $x_0$ 点取得严格的极小值。

**定理 10：设函数 $f$ 在区间 $I$ 连续，在 $I^0$ 二阶可导，而 $x_0$ 是 $f$ 在 $I^0$ 中的唯一的临界点，则有（1）如果 $f^{\prime \prime} > 0$，那么 $f(x_0)$ 是函数 $f$ 在区间 $I$ 上的最小值；（2）如果 $f^{\prime \prime} < 0$，那么 $f(x_0)$ 是函数 $f$ 在区间 $I$ 上的最大值。**

证明：

（1）证明：因为 $f'(x)$ 在 $I^0$ 连续并且只有唯一的零点 $x_0$，所以在 $x_0$ 的左边 $f'(x)$ 保持同一符号。在定理 9 证明已经看到：在 $x_0$ 左侧邻近处有 $f'(x) < 0$。因而对于 $I^0$ 中 $x_0$ 点的左边所有的 $x$ 都应有 $f'(x) < 0$。同样可证：对于 $I^0$ 中 $x_0$ 点的右边所有的 $x$ 都应有 $f'(x) > 0$。这样我们证明了 $f(x_0)$ 是函数 $f$ 在区间 $I$ 的最小值。